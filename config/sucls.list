/**
 * Êõ¥Êñ∞Êó•ÊúüÔºö2024-04-05 15:30:15
 * Áî®Ê≥ïÔºöSub-Store ËÑöÊú¨Êìç‰ΩúÊ∑ªÂä†
 * rename.js ‰ª•‰∏ãÊòØÊ≠§ËÑöÊú¨ÊîØÊåÅÁöÑÂèÇÊï∞ÔºåÂøÖÈ°ª‰ª• # ‰∏∫ÂºÄÂ§¥Â§ö‰∏™ÂèÇÊï∞‰ΩøÁî®"&"ËøûÊé•ÔºåÂèÇËÄÉ‰∏äËø∞Âú∞ÂùÄ‰∏∫‰æã‰ΩøÁî®ÂèÇÊï∞„ÄÇ Á¶ÅÁî®ÁºìÂ≠òurl#noCache
 *
 *** ‰∏ªË¶ÅÂèÇÊï∞
 * [in=] Ëá™Âä®Âà§Êñ≠Êú∫Âú∫ËäÇÁÇπÂêçÁ±ªÂûã ‰ºòÂÖàÁ∫ß zh(‰∏≠Êñá) -> flag(ÂõΩÊóó) -> quan(Ëã±ÊñáÂÖ®Áß∞) -> en(Ëã±ÊñáÁÆÄÂÜô)
 * Â¶ÇÊûú‰∏çÂáÜÁöÑÊÉÖÂÜµ, ÂèØ‰ª•Âä†ÂèÇÊï∞ÊåáÂÆö:
 *
 * [nm]    ‰øùÁïôÊ≤°ÊúâÂåπÈÖçÂà∞ÁöÑËäÇÁÇπ
 * [in=zh] Êàñin=cnËØÜÂà´‰∏≠Êñá
 * [in=en] Êàñin=us ËØÜÂà´Ëã±ÊñáÁº©ÂÜô
 * [in=flag] Êàñin=gq ËØÜÂà´ÂõΩÊóó Â¶ÇÊûúÂä†ÂèÇÊï∞ in=flag ÂàôËØÜÂà´ÂõΩÊóó ËÑöÊú¨Êìç‰ΩúÂâçÈù¢‰∏çË¶ÅÊ∑ªÂä†ÂõΩÊóóÊìç‰Ωú Âê¶ÂàôÁßªÈô§ÂõΩÊóóÂêéÈù¢ËÑöÊú¨ËØÜÂà´‰∏çÂà∞
 * [in=quan] ËØÜÂà´Ëã±ÊñáÂÖ®Áß∞
 *
 * [out=]   ËæìÂá∫ËäÇÁÇπÂêçÂèØÈÄâÂèÇÊï∞: (cnÊàñzh ÔºåusÊàñen ÔºågqÊàñflag Ôºåquan) ÂØπÂ∫îÔºö(‰∏≠ÊñáÔºåËã±ÊñáÁº©ÂÜô ÔºåÂõΩÊóó ÔºåËã±ÊñáÂÖ®Áß∞) ÈªòËÆ§‰∏≠Êñá ‰æãÂ¶Ç [out=en] Êàñ out=us ËæìÂá∫Ëã±ÊñáÁº©ÂÜô
 *** ÂàÜÈöîÁ¨¶ÂèÇÊï∞
 *
 * [fgf=]   ËäÇÁÇπÂêçÂâçÁºÄÊàñÂõΩÊóóÂàÜÈöîÁ¨¶ÔºåÈªòËÆ§‰∏∫Á©∫Ê†ºÔºõ
 * [sn=]    ËÆæÁΩÆÂõΩÂÆ∂‰∏éÂ∫èÂè∑‰πãÈó¥ÁöÑÂàÜÈöîÁ¨¶ÔºåÈªòËÆ§‰∏∫Á©∫Ê†ºÔºõ
 * Â∫èÂè∑ÂèÇÊï∞
 * [one]    Ê∏ÖÁêÜÂè™Êúâ‰∏Ä‰∏™ËäÇÁÇπÁöÑÂú∞Âå∫ÁöÑ01
 * [flag]   ÁªôËäÇÁÇπÂâçÈù¢Âä†ÂõΩÊóó
 *
 *** ÂâçÁºÄÂèÇÊï∞
 * [name=]  ËäÇÁÇπÊ∑ªÂä†Êú∫Âú∫ÂêçÁß∞ÂâçÁºÄÔºõ
 * [nf]     Êää name= ÁöÑÂâçÁºÄÂÄºÊîæÂú®ÊúÄÂâçÈù¢
 *** ‰øùÁïôÂèÇÊï∞
 * [blkey=iplc+gpt+NF+IPLC] Áî®+Âè∑Ê∑ªÂä†Â§ö‰∏™ÂÖ≥ÈîÆËØç ‰øùÁïôËäÇÁÇπÂêçÁöÑËá™ÂÆö‰πâÂ≠óÊÆµ ÈúÄË¶ÅÂå∫ÂàÜÂ§ßÂ∞èÂÜô!
 * Â¶ÇÊûúÈúÄË¶Å‰øÆÊîπ ‰øùÁïôÁöÑÂÖ≥ÈîÆËØç ÊõøÊç¢ÊàêÂà´ÁöÑ ÂèØ‰ª•Áî® > ÂàÜÂâ≤ ‰æãÂ¶Ç [#blkey=GPT>Êñ∞ÂêçÂ≠ó+ÂÖ∂‰ªñÂÖ≥ÈîÆËØç] ËøôÂ∞ÜÊää„ÄêGPT„ÄëÊõøÊç¢Êàê„ÄêÊñ∞ÂêçÂ≠ó„Äë
 * ‰æãÂ¶Ç      https://raw.githubusercontent.com/Keywos/rule/main/rename.js#flag&blkey=GPT>Êñ∞ÂêçÂ≠ó+NF
 * [blgd]   ‰øùÁïô: ÂÆ∂ÂÆΩ IPLC À£¬≤ Á≠â
 * [bl]     Ê≠£ÂàôÂåπÈÖç‰øùÁïô [0.1x, x0.2, 6x ,3ÂÄç]Á≠âÊ†áËØÜ
 * [nx]     ‰øùÁïô1ÂÄçÁéá‰∏é‰∏çÊòæÁ§∫ÂÄçÁéáÁöÑ
 * [blnx]   Âè™‰øùÁïôÈ´òÂÄçÁéá
 * [clear]  Ê∏ÖÁêÜ‰π±Âêç
 * [blpx]   Â¶ÇÊûúÁî®‰∫Ü‰∏äÈù¢ÁöÑblÂèÇÊï∞,ÂØπ‰øùÁïôÊ†áËØÜÂêéÁöÑÂêçÁß∞ÂàÜÁªÑÊéíÂ∫è,Â¶ÇÊûúÊ≤°Áî®‰∏äÈù¢ÁöÑblÂèÇÊï∞ÂçïÁã¨‰ΩøÁî®blpxÂàô‰∏çËµ∑‰ªª‰Ωï‰ΩúÁî®
 * [blockquic] blockquic=on ÈòªÊ≠¢; blockquic=off ‰∏çÈòªÊ≠¢
 */

// const inArg = {'blkey':'iplc+GPT>GPTnewName+NF+IPLC', 'flag':true };
const inArg = $arguments; // console.log(inArg)
const nx = inArg.nx || false,
  bl = inArg.bl || false,
  nf = inArg.nf || false,
  key = inArg.key || false,
  blgd = inArg.blgd || false,
  blpx = inArg.blpx || false,
  blnx = inArg.blnx || false,
  numone = inArg.one || false,
  debug = inArg.debug || false,
  clear = inArg.clear || false,
  addflag = inArg.flag || false,
  nm = inArg.nm || false;

const FGF = inArg.fgf == undefined ? " " : decodeURI(inArg.fgf),
  XHFGF = inArg.sn == undefined ? " " : decodeURI(inArg.sn),
  FNAME = inArg.name == undefined ? "" : decodeURI(inArg.name),
  BLKEY = inArg.blkey == undefined ? "" : decodeURI(inArg.blkey),
  blockquic = inArg.blockquic == undefined ? "" : decodeURI(inArg.blockquic),
  nameMap = {
    cn: "cn",
    zh: "cn",
    us: "us",
    en: "us",
    quan: "quan",
    gq: "gq",
    flag: "gq",
  },
  inname = nameMap[inArg.in] || "",
  outputName = nameMap[inArg.out] || "";
// prettier-ignore
const FG = ['üá≠üá∞','üá≤üá¥','üáπüáº','üáØüáµ','üá∞üá∑','üá∏üá¨','üá∫üá∏','üá¨üáß','üá´üá∑','üá©üá™','üá¶üá∫','üá¶üá™','üá¶üá´','üá¶üá±','üá©üáø','üá¶üá¥','üá¶üá∑','üá¶üá≤','üá¶üáπ','üá¶üáø','üáßüá≠','üáßüá©','üáßüáæ','üáßüá™','üáßüáø','üáßüáØ','üáßüáπ','üáßüá¥','üáßüá¶','üáßüáº','üáßüá∑','üáªüá¨','üáßüá≥','üáßüá¨','üáßüá´','üáßüáÆ','üá∞üá≠','üá®üá≤','üá®üá¶','üá®üáª','üá∞üáæ','üá®üá´','üáπüá©','üá®üá±','üá®üá¥','üá∞üá≤','üá®üá¨','üá®üá©','üá®üá∑','üá≠üá∑','üá®üáæ','üá®üáø','üá©üá∞','üá©üáØ','üá©üá¥','üá™üá®','üá™üá¨','üá∏üáª','üá¨üá∂','üá™üá∑','üá™üá™','üá™üáπ','üá´üáØ','üá´üáÆ','üá¨üá¶','üá¨üá≤','üá¨üá™','üá¨üá≠','üá¨üá∑','üá¨üá±','üá¨üáπ','üá¨üá≥','üá¨üáæ','üá≠üáπ','üá≠üá≥','üá≠üá∫','üáÆüá∏','üáÆüá≥','üáÆüá©','üáÆüá∑','üáÆüá∂','üáÆüá™','üáÆüá≤','üáÆüá±','üáÆüáπ','üá®üáÆ','üáØüá≤','üáØüá¥','üá∞üáø','üá∞üá™','üá∞üáº','üá∞üá¨','üá±üá¶','üá±üáª','üá±üáß','üá±üá∏','üá±üá∑','üá±üáæ','üá±üáπ','üá±üá∫','üá≤üá∞','üá≤üá¨','üá≤üáº','üá≤üáæ','üá≤üáª','üá≤üá±','üá≤üáπ','üá≤üá∑','üá≤üá∫','üá≤üáΩ','üá≤üá©','üá≤üá®','üá≤üá≥','üá≤üá™','üá≤üá¶','üá≤üáø','üá≤üá≤','üá≥üá¶','üá≥üáµ','üá≥üá±','üá≥üáø','üá≥üáÆ','üá≥üá™','üá≥üá¨','üá∞üáµ','üá≥üá¥','üá¥üá≤','üáµüá∞','üáµüá¶','üáµüáæ','üáµüá™','üáµüá≠','üáµüáπ','üáµüá∑','üá∂üá¶','üá∑üá¥','üá∑üá∫','üá∑üáº','üá∏üá≤','üá∏üá¶','üá∏üá≥','üá∑üá∏','üá∏üá±','üá∏üá∞','üá∏üáÆ','üá∏üá¥','üáøüá¶','üá™üá∏','üá±üá∞','üá∏üá©','üá∏üá∑','üá∏üáø','üá∏üá™','üá®üá≠','üá∏üáæ','üáπüáØ','üáπüáø','üáπüá≠','üáπüá¨','üáπüá¥','üáπüáπ','üáπüá≥','üáπüá∑','üáπüá≤','üáªüáÆ','üá∫üá¨','üá∫üá¶','üá∫üáæ','üá∫üáø','üáªüá™','üáªüá≥','üáæüá™','üáøüá≤','üáøüáº','üá¶üá©','üá∑üá™','üáµüá±','üá¨üá∫','üáªüá¶','üá±üáÆ','üá®üáº','üá∏üá®','üá¶üá∂','üá¨üáÆ','üá®üá∫','üá´üá¥','üá¶üáΩ','üáßüá≤','üáπüá±']
// prettier-ignore
const EN = ['HK','MO','TW','JP','KR','SG','US','GB','FR','DE','AU','AE','AF','AL','DZ','AO','AR','AM','AT','AZ','BH','BD','BY','BE','BZ','BJ','BT','BO','BA','BW','BR','VG','BN','BG','BF','BI','KH','CM','CA','CV','KY','CF','TD','CL','CO','KM','CG','CD','CR','HR','CY','CZ','DK','DJ','DO','EC','EG','SV','GQ','ER','EE','ET','FJ','FI','GA','GM','GE','GH','GR','GL','GT','GN','GY','HT','HN','HU','IS','IN','ID','IR','IQ','IE','IM','IL','IT','CI','JM','JO','KZ','KE','KW','KG','LA','LV','LB','LS','LR','LY','LT','LU','MK','MG','MW','MY','MV','ML','MT','MR','MU','MX','MD','MC','MN','ME','MA','MZ','MM','NA','NP','NL','NZ','NI','NE','NG','KP','NO','OM','PK','PA','PY','PE','PH','PT','PR','QA','RO','RU','RW','SM','SA','SN','RS','SL','SK','SI','SO','ZA','ES','LK','SD','SR','SZ','SE','CH','SY','TJ','TZ','TH','TG','TO','TT','TN','TR','TM','VI','UG','UA','UY','UZ','VE','VN','YE','ZM','ZW','AD','RE','PL','GU','VA','LI','CW','SC','AQ','GI','CU','FO','AX','BM','TL'];
// prettier-ignore
const ZH = ['È¶ôÊ∏Ø','Êæ≥Èó®','Âè∞Êπæ','Êó•Êú¨','Èü©ÂõΩ','Êñ∞Âä†Âù°','ÁæéÂõΩ','Ëã±ÂõΩ','Ê≥ïÂõΩ','Âæ∑ÂõΩ','Êæ≥Â§ßÂà©‰∫ö','ÈòøËÅîÈÖã','ÈòøÂØåÊ±ó','ÈòøÂ∞îÂ∑¥Â∞º‰∫ö','ÈòøÂ∞îÂèäÂà©‰∫ö','ÂÆâÂì•Êãâ','ÈòøÊ†πÂª∑','‰∫öÁæéÂ∞º‰∫ö','Â••Âú∞Âà©','ÈòøÂ°ûÊãúÁñÜ','Â∑¥Êûó','Â≠üÂä†ÊãâÂõΩ','ÁôΩ‰øÑÁΩóÊñØ','ÊØîÂà©Êó∂','‰ºØÂà©ÂÖπ','Ë¥ùÂÆÅ','‰∏ç‰∏π','ÁéªÂà©Áª¥‰∫ö','Ê≥¢ÊñØÂ∞º‰∫öÂíåÈªëÂ°ûÂì•Áª¥ÈÇ£','ÂçöËå®Áì¶Á∫≥','Â∑¥Ë•ø','Ëã±Â±ûÁª¥‰∫¨Áæ§Â≤õ','ÊñáËé±','‰øùÂä†Âà©‰∫ö','Â∏ÉÂü∫Á∫≥Ê≥ïÁ¥¢','Â∏ÉÈöÜËø™','Êü¨ÂüîÂØ®','ÂñÄÈ∫¶ÈöÜ','Âä†ÊãøÂ§ß','‰ΩõÂæóËßí','ÂºÄÊõºÁæ§Â≤õ','‰∏≠ÈùûÂÖ±ÂíåÂõΩ','‰πçÂæó','Êô∫Âà©','Âì•‰º¶ÊØî‰∫ö','ÁßëÊë©ÁΩó','ÂàöÊûú(Â∏É)','ÂàöÊûú(Èáë)','Âì•ÊñØËææÈªéÂä†','ÂÖãÁΩóÂú∞‰∫ö','Â°ûÊµ¶Ë∑ØÊñØ','Êç∑ÂÖã','‰∏πÈ∫¶','ÂêâÂ∏ÉÊèê','Â§öÁ±≥Â∞ºÂä†ÂÖ±ÂíåÂõΩ','ÂéÑÁìúÂ§öÂ∞î','ÂüÉÂèä','Ëê®Â∞îÁì¶Â§ö','Ëµ§ÈÅìÂá†ÂÜÖ‰∫ö','ÂéÑÁ´ãÁâπÈáå‰∫ö','Áà±Ê≤ôÂ∞º‰∫ö','ÂüÉÂ°û‰øÑÊØî‰∫ö','ÊñêÊµé','Ëä¨ÂÖ∞','Âä†Ëì¨','ÂÜàÊØî‰∫ö','Ê†ºÈ≤ÅÂêâ‰∫ö','Âä†Á∫≥','Â∏åËÖä','Ê†ºÈôµÂÖ∞','Âç±Âú∞È©¨Êãâ','Âá†ÂÜÖ‰∫ö','Âú≠‰∫öÈÇ£','Êµ∑Âú∞','Ê¥™ÈÉΩÊãâÊñØ','ÂåàÁâôÂà©','ÂÜ∞Â≤õ','Âç∞Â∫¶','Âç∞Â∞º','‰ºäÊúó','‰ºäÊãâÂÖã','Áà±Â∞îÂÖ∞','È©¨ÊÅ©Â≤õ','‰ª•Ëâ≤Âàó','ÊÑèÂ§ßÂà©','ÁßëÁâπËø™Áì¶','Áâô‰π∞Âä†','Á∫¶Êó¶','ÂìàËê®ÂÖãÊñØÂù¶','ËÇØÂ∞º‰∫ö','ÁßëÂ®ÅÁâπ','ÂêâÂ∞îÂêâÊñØÊñØÂù¶','ËÄÅÊåù','ÊãâËÑ±Áª¥‰∫ö','ÈªéÂ∑¥Â´©','Ëé±Á¥¢Êâò','Âà©ÊØîÈáå‰∫ö','Âà©ÊØî‰∫ö','Á´ãÈô∂ÂÆõ','Âç¢Ê£ÆÂ†°','È©¨ÂÖ∂È°ø','È©¨ËææÂä†ÊñØÂä†','È©¨ÊãâÁª¥','È©¨Êù•','È©¨Â∞î‰ª£Â§´','È©¨Èáå','È©¨ËÄ≥‰ªñ','ÊØõÂà©Â°îÂ∞º‰∫ö','ÊØõÈáåÊ±ÇÊñØ','Â¢®Ë•øÂì•','Êë©Â∞îÂ§öÁì¶','Êë©Á∫≥Âì•','ËíôÂè§','ÈªëÂ±±ÂÖ±ÂíåÂõΩ','Êë©Ê¥õÂì•','Ëé´Ê°ëÊØîÂÖã','ÁºÖÁî∏','Á∫≥Á±≥ÊØî‰∫ö','Â∞ºÊ≥äÂ∞î','Ëç∑ÂÖ∞','Êñ∞Ë•øÂÖ∞','Â∞ºÂä†ÊãâÁìú','Â∞ºÊó•Â∞î','Â∞ºÊó•Âà©‰∫ö','ÊúùÈ≤ú','Êå™Â®Å','ÈòøÊõº','Â∑¥Âü∫ÊñØÂù¶','Â∑¥ÊãøÈ©¨','Â∑¥ÊãâÂú≠','ÁßòÈ≤Å','Ëè≤ÂæãÂÆæ','Ëë°ËêÑÁâô','Ê≥¢Â§öÈªéÂêÑ','Âç°Â°îÂ∞î','ÁΩóÈ©¨Â∞º‰∫ö','‰øÑÁΩóÊñØ','Âç¢Êó∫Ëææ','Âú£È©¨ÂäõËØ∫','Ê≤ôÁâπÈòøÊãâ‰ºØ','Â°ûÂÜÖÂä†Â∞î','Â°ûÂ∞îÁª¥‰∫ö','Â°ûÊãâÂà©ÊòÇ','ÊñØÊ¥õ‰ºêÂÖã','ÊñØÊ¥õÊñáÂ∞º‰∫ö','Á¥¢È©¨Èáå','ÂçóÈùû','Ë•øÁè≠Áâô','ÊñØÈáåÂÖ∞Âç°','Ëãè‰∏π','ËãèÈáåÂçó','ÊñØÂ®ÅÂ£´ÂÖ∞','ÁëûÂÖ∏','ÁëûÂ£´','ÂèôÂà©‰∫ö','Â°îÂêâÂÖãÊñØÂù¶','Âù¶Ê°ëÂ∞º‰∫ö','Ê≥∞ÂõΩ','Â§öÂì•','Ê±§Âä†','ÁâπÁ´ãÂ∞ºËææÂíåÂ§öÂ∑¥Âì•','Á™ÅÂ∞ºÊñØ','ÂúüËÄ≥ÂÖ∂','ÂúüÂ∫ìÊõºÊñØÂù¶','ÁæéÂ±ûÁª¥Â∞î‰∫¨Áæ§Â≤õ','‰πåÂπ≤Ëææ','‰πåÂÖãÂÖ∞','‰πåÊãâÂú≠','‰πåÂÖπÂà´ÂÖãÊñØÂù¶','ÂßîÂÜÖÁëûÊãâ','Ë∂äÂçó','‰πüÈó®','ËµûÊØî‰∫ö','Ê¥•Â∑¥Â∏ÉÈü¶','ÂÆâÈÅìÂ∞î','ÁïôÂ∞ºÊ±™','Ê≥¢ÂÖ∞','ÂÖ≥Â≤õ','Ê¢µËíÇÂÜà','ÂàóÊîØÊï¶Â£´Áôª','Â∫ìÊãâÁ¥¢','Â°ûËàåÂ∞î','ÂçóÊûÅ','Áõ¥Â∏ÉÁΩóÈôÄ','Âè§Â∑¥','Ê≥ïÁΩóÁæ§Â≤õ','Â••ÂÖ∞Áæ§Â≤õ','ÁôæÊÖïËææ','‰∏úÂ∏ùÊ±∂'];
// prettier-ignore
const QC = ['Hong Kong','Macao','Taiwan','Japan','Korea','Singapore','United States','United Kingdom','France','Germany','Australia','Dubai','Afghanistan','Albania','Algeria','Angola','Argentina','Armenia','Austria','Azerbaijan','Bahrain','Bangladesh','Belarus','Belgium','Belize','Benin','Bhutan','Bolivia','Bosnia and Herzegovina','Botswana','Brazil','British Virgin Islands','Brunei','Bulgaria','Burkina-faso','Burundi','Cambodia','Cameroon','Canada','CapeVerde','CaymanIslands','Central African Republic','Chad','Chile','Colombia','Comoros','Congo-Brazzaville','Congo-Kinshasa','CostaRica','Croatia','Cyprus','Czech Republic','Denmark','Djibouti','Dominican Republic','Ecuador','Egypt','EISalvador','Equatorial Guinea','Eritrea','Estonia','Ethiopia','Fiji','Finland','Gabon','Gambia','Georgia','Ghana','Greece','Greenland','Guatemala','Guinea','Guyana','Haiti','Honduras','Hungary','Iceland','India','Indonesia','Iran','Iraq','Ireland','Isle of Man','Israel','Italy','Ivory Coast','Jamaica','Jordan','Kazakstan','Kenya','Kuwait','Kyrgyzstan','Laos','Latvia','Lebanon','Lesotho','Liberia','Libya','Lithuania','Luxembourg','Macedonia','Madagascar','Malawi','Malaysia','Maldives','Mali','Malta','Mauritania','Mauritius','Mexico','Moldova','Monaco','Mongolia','Montenegro','Morocco','Mozambique','Myanmar(Burma)','Namibia','Nepal','Netherlands','New Zealand','Nicaragua','Niger','Nigeria','NorthKorea','Norway','Oman','Pakistan','Panama','Paraguay','Peru','Philippines','Portugal','PuertoRico','Qatar','Romania','Russia','Rwanda','SanMarino','SaudiArabia','Senegal','Serbia','SierraLeone','Slovakia','Slovenia','Somalia','SouthAfrica','Spain','SriLanka','Sudan','Suriname','Swaziland','Sweden','Switzerland','Syria','Tajikstan','Tanzania','Thailand','Togo','Tonga','TrinidadandTobago','Tunisia','Turkey','Turkmenistan','U.S.Virgin Islands','Uganda','Ukraine','Uruguay','Uzbekistan','Venezuela','Vietnam','Yemen','Zambia','Zimbabwe','Andorra','Reunion','Poland','Guam','Vatican','Liechtensteins','Curacao','Seychelles','Antarctica','Gibraltar','Cuba','Faroe Islands','Ahvenanmaa','Bermuda','Timor-Leste'];
const specialRegex = [
  /(\d\.)?\d+√ó/,
  /IPLC|IEPL|Kern|Edge|Pro|Std|Exp|Biz|Fam|Game|Buy|Zx|LB|Game/,
];
const nameclear =
  /(Â•óÈ§ê|Âà∞Êúü|ÊúâÊïà|Ââ©‰Ωô|ÁâàÊú¨|Â∑≤Áî®|ËøáÊúü|Â§±ËÅî|ÊµãËØï|ÂÆòÊñπ|ÁΩëÂùÄ|Â§áÁî®|Áæ§|TEST|ÂÆ¢Êúç|ÁΩëÁ´ô|Ëé∑Âèñ|ËÆ¢ÈòÖ|ÊµÅÈáè|Êú∫Âú∫|‰∏ãÊ¨°|ÂÆòÂùÄ|ËÅîÁ≥ª|ÈÇÆÁÆ±|Â∑•Âçï|Â≠¶ÊúØ|USE|USED|TOTAL|EXPIRE|EMAIL)/i;
// prettier-ignore
const regexArray=[/À£¬≤/, /À£¬≥/, /À£‚Å¥/, /À£‚Åµ/, /À£‚Å∂/, /À£‚Å∑/, /À£‚Å∏/, /À£‚Åπ/, /À£¬π‚Å∞/, /À£¬≤‚Å∞/, /À£¬≥‚Å∞/, /À£‚Å¥‚Å∞/, /À£‚Åµ‚Å∞/, /IPLC/i, /IEPL/i, /Ê†∏ÂøÉ/, /ËæπÁºò/, /È´òÁ∫ß/, /Ê†áÂáÜ/, /ÂÆûÈ™å/, /ÂïÜÂÆΩ/, /ÂÆ∂ÂÆΩ/, /Ê∏∏Êàè|game/i, /Ë¥≠Áâ©/, /‰∏ìÁ∫ø/, /LB/, /cloudflare/i, /\budp\b/i, /\bgpt\b/i,/udpn\b/];
// prettier-ignore
const valueArray= [ "2√ó","3√ó","4√ó","5√ó","6√ó","7√ó","8√ó","9√ó","10√ó","20√ó","30√ó","40√ó","50√ó","IPLC","IEPL","Kern","Edge","Pro","Std","Exp","Biz","Fam","Game","Buy","Zx","LB","CF","UDP","GPT","UDPN"];
const nameblnx = /(È´òÂÄç|(?!1)2+(x|ÂÄç)|À£¬≤|À£¬≥|À£‚Å¥|À£‚Åµ|À£¬π‚Å∞)/i;
const namenx = /(È´òÂÄç|(?!1)(0\.|\d)+(x|ÂÄç)|À£¬≤|À£¬≥|À£‚Å¥|À£‚Åµ|À£¬π‚Å∞)/i;
const keya =
  /Ê∏Ø|Hong|HK|Êñ∞Âä†Âù°|SG|Singapore|Êó•Êú¨|Japan|JP|ÁæéÂõΩ|United States|US|Èü©|ÂúüËÄ≥ÂÖ∂|TR|Turkey|Korea|KR|üá∏üá¨|üá≠üá∞|üáØüáµ|üá∫üá∏|üá∞üá∑|üáπüá∑/i;
const keyb =
  /(((1|2|3|4)\d)|(È¶ôÊ∏Ø|Hong|HK) 0[5-9]|((Êñ∞Âä†Âù°|SG|Singapore|Êó•Êú¨|Japan|JP|ÁæéÂõΩ|United States|US|Èü©|ÂúüËÄ≥ÂÖ∂|TR|Turkey|Korea|KR) 0[3-9]))/i;
const rurekey = {
  GB: /UK/g,
  "B-G-P": /BGP/g,
  "Russia Moscow": /Moscow/g,
  "Korea Chuncheon": /Chuncheon|Seoul/g,
  "Hong Kong": /Hongkong|HONG KONG/gi,
  "United Kingdom London": /London|Great Britain/g,
  "Dubai United Arab Emirates": /United Arab Emirates/g,
  "Taiwan TW Âè∞Êπæ üáπüáº": /(Âè∞|Tai\s?wan|TW).*?üá®üá≥|üá®üá≥.*?(Âè∞|Tai\s?wan|TW)/g,
  "United States": /USA|Los Angeles|San Jose|Silicon Valley|Michigan/g,
  Êæ≥Â§ßÂà©‰∫ö: /Êæ≥Ê¥≤|Â¢®Â∞îÊú¨|ÊÇâÂ∞º|ÂúüÊæ≥|(Ê∑±|Ê≤™|Âëº|‰∫¨|Âπø|Êù≠)Êæ≥/g,
  Âæ∑ÂõΩ: /(Ê∑±|Ê≤™|Âëº|‰∫¨|Âπø|Êù≠)Âæ∑(?!.*(I|Á∫ø))|Ê≥ïÂÖ∞ÂÖãÁ¶è|Êª¨Âæ∑/g,
  È¶ôÊ∏Ø: /(Ê∑±|Ê≤™|Âëº|‰∫¨|Âπø|Êù≠)Ê∏Ø(?!.*(I|Á∫ø))/g,
  Êó•Êú¨: /(Ê∑±|Ê≤™|Âëº|‰∫¨|Âπø|Êù≠|‰∏≠|ËæΩ)Êó•(?!.*(I|Á∫ø))|‰∏ú‰∫¨|Â§ßÂùÇ/g,
  Êñ∞Âä†Âù°: /ÁãÆÂüé|(Ê∑±|Ê≤™|Âëº|‰∫¨|Âπø|Êù≠)Êñ∞/g,
  ÁæéÂõΩ: /(Ê∑±|Ê≤™|Âëº|‰∫¨|Âπø|Êù≠)Áæé|Ê≥¢ÁâπÂÖ∞|ËäùÂä†Âì•|Âì•‰º¶Â∏É|Á∫ΩÁ∫¶|Á°ÖË∞∑|‰øÑÂãíÂÜà|Ë•øÈõÖÂõæ|ËäùÂä†Âì•/g,
  Ê≥¢ÊñØÂ∞º‰∫öÂíåÈªëÂ°ûÂì•Áª¥ÈÇ£: /Ê≥¢ÈªëÂÖ±ÂíåÂõΩ/g,
  Âç∞Â∞º: /Âç∞Â∫¶Â∞ºË•ø‰∫ö|ÈõÖÂä†Ëææ/g,
  Âç∞Â∫¶: /Â≠ü‰π∞/g,
  ÈòøËÅîÈÖã: /Ëø™Êãú|ÈòøÊãâ‰ºØËÅîÂêàÈÖãÈïøÂõΩ/g,
  Â≠üÂä†ÊãâÂõΩ: /Â≠üÂä†Êãâ/g,
  Êç∑ÂÖã: /Êç∑ÂÖãÂÖ±ÂíåÂõΩ/g,
  Âè∞Êπæ: /Êñ∞Âè∞|Êñ∞Âåó|Âè∞(?!.*Á∫ø)/g,
  Taiwan: /Taipei/g,
  Èü©ÂõΩ: /Êò•Â∑ù|Èü©|È¶ñÂ∞î/g,
  Japan: /Tokyo|Osaka/g,
  Ëã±ÂõΩ: /‰º¶Êï¶/g,
  India: /Mumbai/g,
  Germany: /Frankfurt/g,
  Switzerland: /Zurich/g,
  ‰øÑÁΩóÊñØ: /Ëé´ÊñØÁßë/g,
  ÂúüËÄ≥ÂÖ∂: /‰ºäÊñØÂù¶Â∏ÉÂ∞î/g,
  Ê≥∞ÂõΩ: /Ê≥∞Âúã|ÊõºË∞∑/g,
  Ê≥ïÂõΩ: /Â∑¥Èªé/g,
  G: /\d\s?GB/gi,
  Esnc: /esnc/gi,
};

let GetK = false, AMK = []
function ObjKA(i) {
  GetK = true
  AMK = Object.entries(i)
}

function operator(pro) {
  const Allmap = {};
  const outList = getList(outputName);
  let inputList,
    retainKey = "";
  if (inname !== "") {
    inputList = [getList(inname)];
  } else {
    inputList = [ZH, FG, QC, EN];
  }

  inputList.forEach((arr) => {
    arr.forEach((value, valueIndex) => {
      Allmap[value] = outList[valueIndex];
    });
  });

  if (clear || nx || blnx || key) {
    pro = pro.filter((res) => {
      const resname = res.name;
      const shouldKeep =
        !(clear && nameclear.test(resname)) &&
        !(nx && namenx.test(resname)) &&
        !(blnx && !nameblnx.test(resname)) &&
        !(key && !(keya.test(resname) && /2|4|6|7/i.test(resname)));
      return shouldKeep;
    });
  }

  const BLKEYS = BLKEY ? BLKEY.split("+") : "";

  pro.forEach((e) => {
    let bktf = false, ens = e.name
    // È¢ÑÂ§ÑÁêÜ Èò≤Ê≠¢È¢ÑÂà§ÊàñÈÅóÊºè
    Object.keys(rurekey).forEach((ikey) => {
      if (rurekey[ikey].test(e.name)) {
        e.name = e.name.replace(rurekey[ikey], ikey);
      if (BLKEY) {
        bktf = true
        let BLKEY_REPLACE = "",
        re = false;
      BLKEYS.forEach((i) => {
        if (i.includes(">") && ens.includes(i.split(">")[0])) {
          if (rurekey[ikey].test(i.split(">")[0])) {
              e.name += " " + i.split(">")[0]
            }
          if (i.split(">")[1]) {
            BLKEY_REPLACE = i.split(">")[1];
            re = true;
          }
        } else {
          if (ens.includes(i)) {
             e.name += " " + i
            }
        }
        retainKey = re
        ? BLKEY_REPLACE
        : BLKEYS.filter((items) => e.name.includes(items));
      });}
      }
    });
    if (blockquic == "on") {
      e["block-quic"] = "on";
    } else if (blockquic == "off") {
      e["block-quic"] = "off";
    } else {
      delete e["block-quic"];
    }

    // Ëá™ÂÆö‰πâ
    if (!bktf && BLKEY) {
      let BLKEY_REPLACE = "",
        re = false;
      BLKEYS.forEach((i) => {
        if (i.includes(">") && e.name.includes(i.split(">")[0])) {
          if (i.split(">")[1]) {
            BLKEY_REPLACE = i.split(">")[1];
            re = true;
          }
        }
      });
      retainKey = re
        ? BLKEY_REPLACE
        : BLKEYS.filter((items) => e.name.includes(items));
    }

    let ikey = "",
      ikeys = "";
    // ‰øùÁïôÂõ∫ÂÆöÊ†ºÂºè ÂÄçÁéá
    if (blgd) {
      regexArray.forEach((regex, index) => {
        if (regex.test(e.name)) {
          ikeys = valueArray[index];
        }
      });
    }

    // Ê≠£Âàô ÂåπÈÖçÂÄçÁéá
    if (bl) {
      const match = e.name.match(
        /((ÂÄçÁéá|X|x|√ó)\D?((\d{1,3}\.)?\d+)\D?)|((\d{1,3}\.)?\d+)(ÂÄç|X|x|√ó)/
      );
      if (match) {
        const rev = match[0].match(/(\d[\d.]*)/)[0];
        if (rev !== "1") {
          const newValue = rev + "√ó";
          ikey = newValue;
        }
      }
    }

    !GetK && ObjKA(Allmap)
    // ÂåπÈÖç Allkey Âú∞Âå∫
    const findKey = AMK.find(([key]) =>
      e.name.includes(key)
    )
    
    let firstName = "",
      nNames = "";

    if (nf) {
      firstName = FNAME;
    } else {
      nNames = FNAME;
    }
    if (findKey?.[1]) {
      const findKeyValue = findKey[1];
      let keyover = [],
        usflag = "";
      if (addflag) {
        const index = outList.indexOf(findKeyValue);
        if (index !== -1) {
          usflag = FG[index];
          usflag = usflag === "üáπüáº" ? "üá®üá≥" : usflag;
        }
      }
      keyover = keyover
        .concat(firstName, usflag, nNames, findKeyValue, retainKey, ikey, ikeys)
        .filter((k) => k !== "");
      e.name = keyover.join(FGF);
    } else {
      if (nm) {
        e.name = FNAME + FGF + e.name;
      } else {
        e.name = null;
      }
    }
  });
  pro = pro.filter((e) => e.name !== null);
  jxh(pro);
  numone && oneP(pro);
  blpx && (pro = fampx(pro));
  key && (pro = pro.filter((e) => !keyb.test(e.name)));
  return pro;
}

// prettier-ignore
function getList(arg) { switch (arg) { case 'us': return EN; case 'gq': return FG; case 'quan': return QC; default: return ZH; }}
// prettier-ignore
function jxh(e) { const n = e.reduce((e, n) => { const t = e.find((e) => e.name === n.name); if (t) { t.count++; t.items.push({ ...n, name: `${n.name}${XHFGF}${t.count.toString().padStart(2, "0")}`, }); } else { e.push({ name: n.name, count: 1, items: [{ ...n, name: `${n.name}${XHFGF}01` }], }); } return e; }, []);const t=(typeof Array.prototype.flatMap==='function'?n.flatMap((e) => e.items):n.reduce((acc, e) => acc.concat(e.items),[])); e.splice(0, e.length, ...t); return e;}
// prettier-ignore
function oneP(e) { const t = e.reduce((e, t) => { const n = t.name.replace(/[^A-Za-z0-9\u00C0-\u017F\u4E00-\u9FFF]+\d+$/, ""); if (!e[n]) { e[n] = []; } e[n].push(t); return e; }, {}); for (const e in t) { if (t[e].length === 1 && t[e][0].name.endsWith("01")) {/* const n = t[e][0]; n.name = e;*/ t[e][0].name= t[e][0].name.replace(/[^.]01/, "") } } return e; }
// prettier-ignore
function fampx(pro) { const wis = []; const wnout = []; for (const proxy of pro) { const fan = specialRegex.some((regex) => regex.test(proxy.name)); if (fan) { wis.push(proxy); } else { wnout.push(proxy); } } const sps = wis.map((proxy) => specialRegex.findIndex((regex) => regex.test(proxy.name)) ); wis.sort( (a, b) => sps[wis.indexOf(a)] - sps[wis.indexOf(b)] || a.name.localeCompare(b.name) ); wnout.sort((a, b) => pro.indexOf(a) - pro.indexOf(b)); return wnout.concat(wis);}

// ===== Sub-Store entrypoint =====
function main(params) {
  // params = { proxies: [...] } ÂΩ¢Âºè
  if (!params) return params;
  if (Array.isArray(params.proxies)) {
    params.proxies = operator(params.proxies);
  }
  return params;
}

module.exports = main;
