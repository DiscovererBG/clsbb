/**
 * Sub-Store rename.jsï¼ˆç»ˆæžç»Ÿä¸€é£Žæ ¼ç‰ˆï¼‰
 * ç»Ÿä¸€è¾“å‡ºæ ¼å¼ï¼š
 *   ðŸ‡¸ðŸ‡¬æ–°åŠ å¡02-0.1å€ | é«˜é€Ÿä¸“çº¿-hy2
 *   ðŸ‡ºðŸ‡¸ç¾Žå›½æ´›æ‰çŸ¶01 | ç”µä¿¡è”é€šç§»åŠ¨æŽ¨è
 *
 * âœ… å¼ºåˆ¶æ‰€æœ‰èŠ‚ç‚¹ç»Ÿä¸€â€œå·¦ä¾§åœ°åŒº+åºå·(+å€çŽ‡)â€ + " | " + â€œå³ä¾§æè¿°â€
 * âœ… å›½æ——ï¼šåŽŸåæœ‰å°±ç”¨åŽŸåï¼›åŽŸåæ²¡æœ‰å°±è‡ªåŠ¨è¡¥ï¼ˆè¯†åˆ«åˆ°å›½å®¶å°±ä¸€å®šæœ‰ï¼‰
 * âœ… åºå·ï¼šä¸é‡æŽ’ï¼åªè¯»å–åŽŸåé‡Œçš„åºå·ï¼ˆ01/02/3/4 -> 03/04ï¼‰
 * âœ… å€çŽ‡ï¼šåŽŸåæœ‰å°±ä¿ç•™ï¼ˆ0.1å€ / 2Ã— / x2 / Ë£Â²...ï¼‰ï¼Œæ”¾å·¦ä¾§ï¼š02-0.1å€
 * âœ… å³ä¾§æè¿°ï¼šåŽ»é‡ã€åŽ»å›½å®¶/åŸŽå¸‚/åºå·/å€çŽ‡ï¼Œä¸å†â€œé«˜é€Ÿ ä¸“çº¿ æŽ¨èâ€é‡å¤å åŠ 
 * âœ… ä¸åŠ¨ä»£ç†å­—æ®µï¼šåªæ”¹ nameï¼ˆä¿è¯å®¢æˆ·ç«¯åè®®è¡Œæ­£å¸¸æ˜¾ç¤ºï¼‰
 */

const inArg = typeof $arguments !== "undefined" ? $arguments : {};

// ------- é»˜è®¤å¼€å…³ï¼ˆä½ è¦çš„æ•ˆæžœé»˜è®¤å…¨å¼€ï¼‰-------
const nm = inArg.nm !== undefined ? !!inArg.nm : true;          // æœªåŒ¹é…ä¹Ÿä¿ç•™
const addflag = inArg.flag !== undefined ? !!inArg.flag : true; // å°½é‡ä¿è¯æœ‰å›½æ——
const keepRatio = inArg.bl !== undefined ? !!inArg.bl : true;   // ä¿ç•™å€çŽ‡
const SEP = typeof inArg.sep === "string" ? decodeURI(inArg.sep) : " | ";
const FNAME = inArg.name ? decodeURI(inArg.name) : "";
const nf = !!inArg.nf;

// ------- ISO2 -> ä¸­æ–‡åï¼ˆå¸¸ç”¨è¶³å¤Ÿï¼›ä¸åœ¨è¡¨é‡Œä¹Ÿä¸ä¼šä¸¢ï¼Œç›´æŽ¥æ˜¾ç¤º ISO2ï¼‰-------
const ISO2_ZH = {
  HK: "é¦™æ¸¯", MO: "æ¾³é—¨", TW: "å°æ¹¾", JP: "æ—¥æœ¬", KR: "éŸ©å›½", SG: "æ–°åŠ å¡", US: "ç¾Žå›½",
  GB: "è‹±å›½", UK: "è‹±å›½", DE: "å¾·å›½", FR: "æ³•å›½", IT: "æ„å¤§åˆ©", ES: "è¥¿ç­ç‰™", NL: "è·å…°",
  CH: "ç‘žå£«", SE: "ç‘žå…¸", NO: "æŒªå¨", DK: "ä¸¹éº¦", FI: "èŠ¬å…°", IE: "çˆ±å°”å…°", PT: "è‘¡è„ç‰™",
  AT: "å¥¥åœ°åˆ©", BE: "æ¯”åˆ©æ—¶", PL: "æ³¢å…°", CZ: "æ·å…‹", HU: "åŒˆç‰™åˆ©", GR: "å¸Œè…Š",
  RU: "ä¿„ç½—æ–¯", UA: "ä¹Œå…‹å…°",
  TR: "åœŸè€³å…¶", AE: "é˜¿è”é…‹", SA: "æ²™ç‰¹", IL: "ä»¥è‰²åˆ—", QA: "å¡å¡”å°”", BH: "å·´æž—", OM: "é˜¿æ›¼",
  IN: "å°åº¦", ID: "å°å°¼", VN: "è¶Šå—", TH: "æ³°å›½", MY: "é©¬æ¥è¥¿äºš", PH: "è²å¾‹å®¾",
  AU: "æ¾³å¤§åˆ©äºš", NZ: "æ–°è¥¿å…°", CA: "åŠ æ‹¿å¤§",
};

// è‹±æ–‡å›½å®¶å -> ISO2ï¼ˆè¯†åˆ«ç”¨ï¼‰
const ENNAME_ISO2 = [
  [/hong\s*kong/i, "HK"],
  [/macao|macau/i, "MO"],
  [/taiwan/i, "TW"],
  [/japan/i, "JP"],
  [/korea|south\s*korea/i, "KR"],
  [/singapore/i, "SG"],
  [/united\s*states|usa\b/i, "US"],
  [/united\s*kingdom|great\s*britain|england|uk\b/i, "GB"],
  [/germany/i, "DE"],
  [/france/i, "FR"],
  [/russia/i, "RU"],
  [/turkey/i, "TR"],
  [/united\s*arab\s*emirates|uae\b|dubai/i, "AE"],
  [/australia/i, "AU"],
  [/canada/i, "CA"],
];

// åŸŽå¸‚å…³é”®è¯ï¼ˆè¢«è¯†åˆ«åˆ°å°±æ‹¼åœ¨å›½å®¶åŽé¢ï¼Œå¦‚ï¼šç¾Žå›½æ´›æ‰çŸ¶ï¼‰
const CITY_KEYWORDS = [
  // JP
  "ä¸œäº¬","å¤§é˜ª","åå¤å±‹","æœ­å¹Œ","ç¦å†ˆ","å†²ç»³",
  // TW
  "å°åŒ—","æ–°åŒ—","æ¡ƒå›­","å°ä¸­","é«˜é›„",
  // HK
  "ä¹é¾™","ä¸­çŽ¯","æ²™ç”°",
  // SG
  "æ–°åŠ å¡",
  // US
  "æ´›æ‰çŸ¶","åœ£ä½•å¡ž","çº½çº¦","è¥¿é›…å›¾","èŠåŠ å“¥","è¾¾æ‹‰æ–¯","åŽç››é¡¿","ç¡…è°·","æ³¢ç‰¹å…°",
  "Los Angeles","San Jose","New York","Seattle","Chicago","Dallas","Washington","Silicon Valley","Portland",
  // EU
  "ä¼¦æ•¦","æ³•å…°å…‹ç¦","å·´é»Ž","é˜¿å§†æ–¯ç‰¹ä¸¹","è‹é»Žä¸–","é©¬å¾·é‡Œ",
  "London","Frankfurt","Paris","Amsterdam","Zurich","Madrid",
  // ME
  "è¿ªæ‹œ","é˜¿å¸ƒæ‰Žæ¯”","å¤šå“ˆ","åˆ©é›…å¾—",
  "Dubai","Abu Dhabi","Doha","Riyadh",
  // KR
  "é¦–å°”","é‡œå±±","æ˜¥å·","ä»å·",
  "Seoul","Busan","Chuncheon","Incheon",
];

// å³ä¾§æè¿°ï¼šæˆ‘ä»¬åªä¿ç•™è¿™äº›â€œæ„ä¹‰è¯â€ï¼Œå¹¶åšè§„èŒƒåŒ–åŽ»é‡ï¼ˆä½ æƒ³è¦çš„ é«˜é€Ÿ/ä¸“çº¿/æŽ¨è/è¿è¥å•†/åè®®æ ‡ç­¾/çº¿è·¯æ ‡ç­¾/å€çŽ‡ä¸åœ¨å³ä¾§ï¼‰
const KEEP_WORDS = [
  // çº¿è·¯/è´¨é‡
  "é«˜é€Ÿ","ä¸“çº¿","æŽ¨è","å®¶å®½","å•†å®½","æ¸¸æˆ","IPLC","IEPL","BGP","CN2","GIA","CMI",
  "AWS","CF","Cloudflare",
  // è¿è¥å•†
  "ç§»åŠ¨","è”é€š","ç”µä¿¡",
  // åè®®/ç‰¹æ€§ï¼ˆä½œä¸ºâ€œå³ä¾§æ ‡ç­¾â€ï¼Œè®©åå­—çœ‹èµ·æ¥åƒä½ å›¾2é‚£æ ·ï¼šé«˜é€Ÿä¸“çº¿-hy2ï¼‰
  "hy2","hy","tuic","reality","xudp","udp","quic","grpc","ws","h2",
  // å…¶ä»–å¸¸è§
  "GPT","Netflix","Disney","HBO"
];

// è§„èŒƒåŒ–æ˜ å°„ï¼šæŠŠå„ç§å†™æ³•ç»Ÿä¸€æˆçŸ­æ ‡ç­¾
function normalizeToken(t) {
  const s = (t || "").trim();
  if (!s) return "";
  const low = s.toLowerCase();

  if (low === "hysteria2" || low === "hys2") return "hy2";
  if (low === "hysteria") return "hy";
  if (low === "xudp") return "xudp";
  if (low === "udp") return "udp";
  if (low === "quic") return "quic";
  if (low === "gpt") return "GPT";
  if (low === "cloudflare" || low === "cf") return "CF";
  if (low === "aws") return "AWS";
  if (low === "reality") return "reality";
  if (low === "tuic") return "tuic";

  return s;
}

// ---------- åŸºç¡€å·¥å…· ----------
function tidy(s) {
  return (s || "")
    .replace(/\s+/g, " ")
    .replace(/\s*\|\s*/g, " | ")
    .replace(/\s*-\s*/g, "-")
    .trim();
}

function stripFlags(s) {
  return (s || "").replace(/[\u{1F1E6}-\u{1F1FF}]{2}/gu, "").trim();
}

function flagToISO2(flag) {
  const cps = [...flag].map(ch => ch.codePointAt(0));
  if (cps.length !== 2) return "";
  const A = 0x1F1E6;
  const c1 = cps[0] - A;
  const c2 = cps[1] - A;
  if (c1 < 0 || c1 > 25 || c2 < 0 || c2 > 25) return "";
  return String.fromCharCode(65 + c1) + String.fromCharCode(65 + c2);
}

function iso2ToFlag(iso2) {
  if (!/^[A-Z]{2}$/.test(iso2)) return "";
  const A = 0x1F1E6;
  const c1 = iso2.charCodeAt(0) - 65;
  const c2 = iso2.charCodeAt(1) - 65;
  return String.fromCodePoint(A + c1) + String.fromCodePoint(A + c2);
}

// å€çŽ‡ï¼ˆæ”¾å·¦ä¾§ï¼‰
function pickRatio(name) {
  if (!keepRatio) return "";
  const n = name || "";

  const sup = n.match(/Ë£[Â²Â³â´âµâ¶â·â¸â¹]|Ë£Â¹â°|Ë£Â²â°|Ë£Â³â°|Ë£â´â°|Ë£âµâ°/);
  if (sup) return sup[0];

  const m =
    n.match(/(\d+(?:\.\d+)?\s*(?:å€|x|X|Ã—))/) ||
    n.match(/(?:x|X|Ã—)\s*(\d+(?:\.\d+)?)/);
  if (!m) return "";

  const raw = m[0].replace(/\s+/g, "");
  if (/^(x|X|Ã—)\d/.test(raw)) return raw.replace(/^(x|X)/, "") + "Ã—";
  if (/^\d+(\.\d+)?(x|X)$/.test(raw)) return raw.replace(/(x|X)$/, "Ã—");
  return raw;
}

// åºå·ï¼šå–â€œåŽŸåé‡Œçš„åºå·â€ï¼Œä¸åšå…¨å±€é‡æŽ’
function pickIndex(name) {
  const n = name || "";
  const m = n.match(/(?:\s|-|_|\|)?(\d{2})(?!\d)\s*$/);
  if (m) return m[1];
  const m2 = n.match(/(?:\s|-|_|\|)?(\d)(?!\d)\s*$/);
  if (m2) return "0" + m2[1];
  return "";
}

function pickCity(raw) {
  const s = raw || "";
  for (const k of CITY_KEYWORDS) {
    const re = new RegExp(k.replace(/[.*+?^${}()|[\]\\]/g, "\\$&"), "i");
    if (re.test(s)) return k;
  }
  return "";
}

// å›½å®¶è¯†åˆ«ï¼šå›½æ—— > ISO2 > è‹±æ–‡å›½å®¶å > ä¸­æ–‡å…³é”®è¯
function detectCountry(rawName) {
  const raw = rawName || "";

  const flagMatch = raw.match(/[\u{1F1E6}-\u{1F1FF}]{2}/u);
  if (flagMatch) {
    const flag = flagMatch[0];
    const iso2 = flagToISO2(flag);
    const zh = ISO2_ZH[iso2] || iso2 || "æœªçŸ¥";
    return { iso2, zh, flag };
  }

  // ISO2ï¼ˆé¿å…è¯¯ä¼¤ asus ä¹‹ç±»ï¼‰
  const iso2Match = raw.match(/\b([A-Z]{2})\b/);
  if (iso2Match) {
    const iso2 = iso2Match[1].toUpperCase();
    const zh = ISO2_ZH[iso2] || iso2;
    const flag = iso2ToFlag(iso2);
    return { iso2, zh, flag };
  }

  for (const [re, iso2] of ENNAME_ISO2) {
    if (re.test(raw)) {
      const zh = ISO2_ZH[iso2] || iso2;
      const flag = iso2ToFlag(iso2);
      return { iso2, zh, flag };
    }
  }

  // ä¸­æ–‡å…³é”®è¯å…œåº•ï¼ˆå¤Ÿç”¨ï¼‰
  const cn = [
    [/é¦™æ¸¯/, "HK"], [/æ¾³é—¨/, "MO"], [/å°æ¹¾|å°åŒ—|æ–°åŒ—|é«˜é›„|å°ä¸­/, "TW"],
    [/æ—¥æœ¬|ä¸œäº¬|å¤§é˜ª|åå¤å±‹|æœ­å¹Œ|ç¦å†ˆ/, "JP"],
    [/æ–°åŠ å¡|ç‹®åŸŽ/, "SG"],
    [/ç¾Žå›½|æ´›æ‰çŸ¶|åœ£ä½•å¡ž|çº½çº¦|è¥¿é›…å›¾|èŠåŠ å“¥|ç¡…è°·/, "US"],
    [/éŸ©å›½|é¦–å°”|é‡œå±±|ä»å·|æ˜¥å·/, "KR"],
    [/è‹±å›½|ä¼¦æ•¦/, "GB"],
    [/å¾·å›½|æ³•å…°å…‹ç¦/, "DE"],
    [/æ³•å›½|å·´é»Ž/, "FR"],
    [/æ¾³å¤§åˆ©äºš|æ‚‰å°¼|å¢¨å°”æœ¬/, "AU"],
    [/è¿ªæ‹œ|é˜¿è”é…‹/, "AE"],
    [/åœŸè€³å…¶|ä¼Šæ–¯å¦å¸ƒå°”/, "TR"],
    [/å°åº¦|å­Ÿä¹°|å¾·é‡Œ/, "IN"],
    [/ä¿„ç½—æ–¯|èŽ«æ–¯ç§‘/, "RU"],
  ];
  for (const [re, iso2] of cn) {
    if (re.test(raw)) {
      const zh = ISO2_ZH[iso2] || iso2;
      const flag = iso2ToFlag(iso2);
      return { iso2, zh, flag };
    }
  }

  return null;
}

// å³ä¾§æè¿°æå–ï¼šåªä¿ç•™â€œæ„ä¹‰è¯â€ï¼Œå¹¶åŽ»é‡ï¼›å¦‚æžœå­˜åœ¨ hy2/tuic/reality/xudp ç­‰ï¼Œä¼˜å…ˆæ‹¼æˆ â€œé«˜é€Ÿä¸“çº¿-hy2â€
function buildDesc(rawNoFlag, info, city, idx, ratio) {
  let s = tidy(rawNoFlag);

  // åŽ»å€çŽ‡
  if (ratio) {
    const r = ratio.replace(/[.*+?^${}()|[\]\\]/g, "\\$&");
    s = s.replace(new RegExp(r, "g"), " ");
  }

  // åŽ»åºå·ï¼ˆæœ«å°¾ï¼‰
  if (idx) {
    s = s.replace(new RegExp(`(?:\\s|-|_|\|)?${idx}(?!\\d)\\s*$`), " ");
  }

  // åŽ»å›½å®¶/ISO2/è‹±æ–‡å›½å®¶å
  if (info) {
    if (info.zh) s = s.replace(new RegExp(info.zh, "g"), " ");
    if (info.iso2) s = s.replace(new RegExp(`\\b${info.iso2}\\b`, "gi"), " ");
  }
  for (const [re] of ENNAME_ISO2) s = s.replace(re, " ");

  // åŽ»åŸŽå¸‚ï¼ˆå¦‚æžœè¢«è¯†åˆ«å‡ºæ¥ç”¨åœ¨å·¦ä¾§ï¼‰
  if (city) {
    const cre = new RegExp(city.replace(/[.*+?^${}()|[\]\\]/g, "\\$&"), "gi");
    s = s.replace(cre, " ");
  }

  // åŽ»åˆ†éš”ç¬¦ï¼Œæ‹†è¯
  s = s.replace(/[|]/g, " ");
  const parts = tidy(s)
    .replace(/[_/]+/g, " ")
    .replace(/[()ã€ã€‘\[\]]/g, " ")
    .split(/[\s-]+/)
    .map(x => x.trim())
    .filter(Boolean);

  // åªä¿ç•™æˆ‘ä»¬è¦çš„å…³é”®è¯ï¼ˆå¹¶è§„èŒƒåŒ–ï¼‰
  const kept = [];
  for (const p of parts) {
    const n = normalizeToken(p);
    if (!n) continue;

    // å…è®¸ â€œé«˜é€Ÿä¸“çº¿-hy2â€ é‡Œçš„ hy2/hysteria2 è¿™ç§æ¥è‡ªåŽŸå
    const low = n.toLowerCase();
    const isWanted =
      KEEP_WORDS.some(w => w.toLowerCase() === low) ||
      KEEP_WORDS.some(w => (w.toLowerCase() === "hy2" && low.includes("hy2")));

    if (!isWanted) continue;

    // åŽ»é‡ï¼ˆä¸åŒºåˆ†å¤§å°å†™ï¼‰
    if (!kept.some(x => x.toLowerCase() === n.toLowerCase())) kept.push(n);
  }

  // ç»„åˆè§„åˆ™ï¼š
  // 1) å¦‚æžœåŒæ—¶æœ‰ â€œé«˜é€Ÿâ€ å’Œ â€œä¸“çº¿â€ï¼Œåˆæˆ â€œé«˜é€Ÿä¸“çº¿â€
  // 2) å¦‚æžœå«åè®®æ ‡ç­¾ hy2/tuic/reality/xudp/udp/quic/grpc/ws/h2ï¼Œåˆ™ç”¨ â€œé«˜é€Ÿä¸“çº¿-åè®®â€
  let speed = "";
  const hasHigh = kept.some(x => x === "é«˜é€Ÿ");
  const hasLine = kept.some(x => x === "ä¸“çº¿");
  if (hasHigh && hasLine) speed = "é«˜é€Ÿä¸“çº¿";
  else if (hasHigh) speed = "é«˜é€Ÿ";
  else if (hasLine) speed = "ä¸“çº¿";

  // åè®®æ ‡ç­¾ä¼˜å…ˆçº§
  const protoOrder = ["hy2","tuic","reality","xudp","udp","quic","grpc","ws","h2","hy"];
  let proto = "";
  for (const po of protoOrder) {
    if (kept.some(x => x.toLowerCase() === po)) { proto = po; break; }
  }

  // è¿è¥å•†/æŽ¨èç­‰å‰©ä½™è¯ï¼ˆä¿æŒé¡ºåºï¼‰
  const rest = kept.filter(x => {
    const low = x.toLowerCase();
    if (x === "é«˜é€Ÿ" || x === "ä¸“çº¿") return false;
    if (proto && low === proto) return false;
    return true;
  });

  let desc = "";
  if (speed && proto) desc = `${speed}-${proto}`;
  else if (speed) desc = speed;
  else if (proto) desc = proto;

  if (rest.length) {
    // æŠŠâ€œç”µä¿¡ è”é€š ç§»åŠ¨ æŽ¨èâ€ç»„åˆæˆæ›´åƒä½ æœºåœºçš„æè¿°
    const telecom = [];
    ["ç”µä¿¡","è”é€š","ç§»åŠ¨"].forEach(k => { if (rest.includes(k)) telecom.push(k); });
    const hasRec = rest.includes("æŽ¨è");
    const other = rest.filter(x => !["ç”µä¿¡","è”é€š","ç§»åŠ¨","æŽ¨è"].includes(x));

    let tail = "";
    if (telecom.length && hasRec) tail = `${telecom.join("")}æŽ¨è`;
    else if (telecom.length) tail = telecom.join("");
    else if (hasRec) tail = "æŽ¨è";

    const merged = [desc, tail, ...other].filter(Boolean);
    desc = merged.join(" ").trim();
  }

  // å¦‚æžœæœ€ç»ˆä¸ºç©ºï¼šç”¨åŽŸå§‹å‰©ä½™æ–‡æœ¬å…œåº•ï¼ˆä½†ä¹ŸåšåŽ»é‡ç©ºæ ¼ï¼‰
  if (!desc) desc = tidy(s);

  return tidy(desc);
}

// æž„é€ æœ€ç»ˆåå­—ï¼ˆå¼ºåˆ¶ç»Ÿä¸€ï¼‰
function buildName(oldName) {
  const raw0 = tidy(oldName);
  if (!raw0) return raw0;

  const rawNoFlag = tidy(stripFlags(raw0));
  const info = detectCountry(raw0);

  // åºå·/å€çŽ‡ä»Žâ€œåŽ»å›½æ——åŽçš„åå­—â€é‡Œå–
  const idx = pickIndex(rawNoFlag);
  const ratio = pickRatio(rawNoFlag);

  // åŸŽå¸‚ï¼ˆç”¨äºŽå·¦ä¾§æ‹¼æŽ¥ï¼‰
  const city = pickCity(raw0);

  if (!info) {
    // æ²¡è¯†åˆ«åˆ°å›½å®¶ï¼šæŒ‰ nm å†³å®š
    return nm ? (FNAME ? `${FNAME} ${rawNoFlag}` : rawNoFlag) : null;
  }

  // å·¦ä¾§ï¼šå›½æ——+å›½å®¶+åŸŽå¸‚+åºå·(+å€çŽ‡)
  const flag = addflag ? (info.flag || iso2ToFlag(info.iso2 || "")) : "";
  const region = `${info.zh}${city && !String(city).includes(info.zh) ? city : ""}`;
  const ratioPart = ratio ? `-${ratio}` : "";
  const left = `${flag}${region}${idx ? idx : ""}${ratioPart}`;

  // å³ä¾§ï¼šæè¿°ï¼ˆç»Ÿä¸€ã€åŽ»é‡ã€ä¿ç•™ hy2 ç­‰æ ‡ç­¾ï¼‰
  const desc = buildDesc(rawNoFlag, info, city, idx, ratio);

  let finalName = `${left}${SEP}${desc}`;

  // å‰ç¼€ name=ï¼ˆä½ éœ€è¦å†åŠ ï¼‰
  if (FNAME) finalName = nf ? `${FNAME} ${finalName}` : `${FNAME} ${finalName}`;

  return tidy(finalName);
}

// name å¿…é¡»å”¯ä¸€ï¼šé‡å¤å°± #2 #3
function ensureUnique(list) {
  const seen = new Map();
  for (const p of list) {
    const n = p.name;
    const c = seen.get(n) || 0;
    if (c === 0) seen.set(n, 1);
    else {
      seen.set(n, c + 1);
      p.name = `${n}#${c + 1}`;
    }
  }
  return list;
}

// Sub-Store å…¥å£
function operator(proxies) {
  if (!Array.isArray(proxies)) return proxies;

  for (const p of proxies) {
    if (!p || !p.name) continue;

    const newName = buildName(p.name);
    if (newName === null) {
      p.name = null;
      continue;
    }
    p.name = newName;

    // å…³é”®ï¼šä¸æ”¹ p å…¶å®ƒå­—æ®µï¼Œå®¢æˆ·ç«¯åè®®è¡Œæ‰èƒ½è‡ªåŠ¨æ˜¾ç¤ºï¼ˆvless/xudpã€hy2/udpï¼‰
  }

  const out = proxies.filter(p => p && p.name);
  return ensureUnique(out);
}
